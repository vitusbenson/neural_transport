import numpy as np

DIMS = {
    "latlon4": dict(lat=45, lon=72, height=19),
    "latlon2": dict(lat=90, lon=144, height=34),
    "latlon1": dict(lat=181, lon=360, height=19),
    "icon": dict(cell=20480, height=19),
    "icosaL5": dict(cell=20480, height=19),
    "icosaL4": dict(cell=5120, height=19),
    "icosaL3": dict(cell=1280, height=19),
}

DEFAULT_GRIDS = dict(
    carboscope="latlon4", egg4="latlon1", camsfc="latlon1", carbontracker="latlon2"
)

LATLON_PROTOTYPE_COORDS = {
    "latlon4": dict(lat=np.linspace(-88, 88, 45), lon=np.linspace(-180, 175, 72)),
    "latlon2": dict(lat=np.linspace(-89, 89, 90), lon=np.linspace(-178.5, 178.5, 144)),
    "latlon1": dict(lat=np.linspace(-90, 90, 181), lon=np.linspace(0, 359, 360)),
}

# fmt: off
EGG4_HEIGHT = [
    1, 2, 3, 5, 7, 10, 20, 30, 50, 70, 100, 150, 200, 250, 300, 400, 500, 600, 700, 800, 850, 900, 925, 950, 1000,
]

CAMSFC_HEIGHT = [
    1, 2, 3, 5, 7, 10, 20, 30, 50, 70, 100, 150, 200, 250, 300, 400, 500, 700, 850, 925, 1000,
]

CARBOSCOPE_HEIGHT = [
    1013.0, 1002.87, 986.8443, 966.9997, 942.637, 877.6834, 787.84045, 673.46265, 542.2488, 408.58344, 287.90472, 235.88718, 190.27179, 151.09908, 118.05502, 90.612854, 68.10399, 49.8396, 23.39017,
]

CARBONTRACKER_HEIGHT = [
    9.6205969e02, 9.5344867e02, 9.3724054e02, 9.1289655e02, 8.7725018e02, 8.3036420e02, 7.7615771e02, 7.1108643e02, 6.4732275e02, 5.7938220e02, 5.2086908e02, 4.8320065e02, 4.4741156e02, 4.1372739e02, 3.8207999e02, 3.4553558e02, 3.1128784e02, 2.8607285e02, 2.5710156e02, 2.2520422e02, 2.0088553e02, 1.7908185e02, 1.5524625e02, 1.3402344e02, 1.1521425e02, 9.6265671e01, 7.9630470e01, 6.7339714e01, 5.0337818e01, 2.8204695e01, 1.2295965e01, 5.2308245e00, 2.1191823e00, 5.3707880e-01,
]
# fmt: on

HEIGHTS = {
    "carboscope": CARBOSCOPE_HEIGHT,
    "egg4": EGG4_HEIGHT,
    "camsfc": CAMSFC_HEIGHT,
    "carbontracker": CARBONTRACKER_HEIGHT,
}

# fmt: off
CARBOSCOPE_79_LOCATIONS = [
    ["hbBRWk+fbBRWk+fbBRWco", 71.32, -156.61, 12.50],
    ["fbSHIPICABk", 82.85, -139.35, 0.00],
    ["fsLJOENWA2k+fsLJONWA2k+fsLJONW", 40.00, -126.00, 15.00],
    ["hbMLOk+fbMLOk", 19.53, -155.58, 3397.00],
    ["fbSPOk+1994.0+fbSPOs", -89.98, -24.80, 2810.00],
    ["frSHMco", 52.72, 174.11, 27.00],
    ["frMIDco", 28.21, -177.37, 10.00],
    ["drMNMjw", 24.29, 153.98, 27.00],
    ["hrSMOco+frSMOco+frSMOk", -14.24, -170.57, 51.00],
    ["frCBAs+frCBAco", 55.21, -162.71, 41.00],
    ["dcETLm", 54.35, -104.98, 493.00],
    ["dcESTm", 51.67, -110.21, 707.00],
    ["fsESPa+dsESPm+fsESPm", 49.38, -126.54, 27.00],
    ["dcBRAm", 50.20, -104.71, 595.00],
    ["dcFSDm", 49.88, -81.57, 250.00],
    ["dcEGBm", 44.22, -79.70, 251.00],
    ["dcDWNm", 43.78, -79.47, 198.00],
    ["drWSAm+frWSAm", 43.93, -60.01, 5.00],
    ["ftLEFco", 45.93, -90.26, -396.00],
    ["fcUTAco", 39.90, -113.72, 1332.00],
    ["fmNWRco", 40.04, -105.60, 3526.00],
    ["fcSGPco", 36.71, -97.49, 356.50],
    ["dtAMT107co", 45.03, -68.68, -107.00],
    ["dtWGC484co", 38.26, -121.49, -484.00],
    ["dtSCT305co", 33.41, -81.83, -304.00],
    ["dtSNP017co", 38.62, -78.35, -17.00],
    ["fsKEYco", 25.67, -80.18, 4.50],
    ["fmMEXco", 18.98, -97.31, 4469.00],
    ["frRPBco", 13.16, -59.43, 19.00],
    ["fcSUMco", 72.60, -38.42, 3214.00],
    ["frBMWco", 32.26, -64.88, 46.50],
    ["nrIZOxw", 28.31, -16.50, 2392.00],
    ["fsCVOb", 16.86, -24.87, 10.00],
    ["frASCco", -7.97, -14.40, 88.50],
    ["frZEPco", 78.91, 11.89, 479.00],
    ["dcPALxi+fcPALco", 67.96, 24.12, 573.50],
    ["fcTERvw", 69.20, 35.10, 42.00],
    ["frSISa+frSISb", 59.97, -1.26, 26.50],
    ["fsMHDco", 53.32, -9.81, 19.00],
    ["dsWAOxi", 52.95, 1.12, -10.00],
    ["dtCBW207xi", 51.97, 4.93, -207.00],
    ["dsLUTri", 53.40, 6.35, 61.00],
    ["dtBIK300bi+ftBIK300b", 53.22, 23.01, -300.00],
    ["nmKASxi", 49.23, 19.98, 1994.00],
    ["nmPUYli", 45.77, 2.97, 1475.00],
    ["fcHPBco", 47.80, 11.02, 990.00],
    ["nmSSLui", 47.92, 7.92, 1228.50],
    ["nmZUGuw+nmZSFuw", 47.42, 10.98, 2815.50],
    ["ftHUNco", 46.95, 16.64, -96.00],
    ["nmJFJei+fmJFJb", 46.55, 7.98, 3582.50],
    ["nmPRSxi", 45.93, 7.70, 3490.00],
    ["nmCMNxj", 44.18, 10.69, 2169.00],
    ["fcCIBco", 41.81, -4.93, 848.50],
    ["fsLMPco", 35.51, 12.62, 50.00],
    ["dsBISli", 44.38, -1.23, 120.00],
    ["dtTRN180li", 47.96, 2.11, -180.00],
    ["fcWISco", 30.41, 34.92, 319.00],
    ["frASKco", 23.26, 5.63, 2715.00],
    ["fcNMBco", -23.57, 15.02, 461.00],
    ["dsCPTxw+fsCPTco", -34.35, 18.49, 260.00],
    ["fcUUMco", 44.45, 111.10, 1012.00],
    ["fmWLGco", 36.28, 100.91, 3852.50],
    ["dsAMYxw+fsAMYco", 36.54, 126.33, 107.50],
    ["fsCOIn", 43.15, 145.50, 45.00],
    ["dsRYOjw", 39.03, 141.82, 280.00],
    ["drYONjw", 24.47, 123.01, 50.00],
    ["frHATn", 24.05, 123.80, 10.00],
    ["fsDSIco", 20.70, 116.73, 8.00],
    ["frSEYco", -4.68, 55.53, 7.00],
    ["frPSAs+frPSAco", -64.85, -64.03, 12.50],
    ["hrSYOx", -69.00, 39.58, 29.00],
    ["frCRZco", -46.43, 51.85, 202.00],
    ["frMAAa", -67.62, 62.87, 42.00],
    ["drAMSl", -37.80, 77.54, 55.00],
    ["fsCYAa", -66.28, 110.52, 55.00],
    ["frMQAa", -54.48, 158.97, 13.00],
    ["fsBHDk", -41.40, 174.90, 85.00],
    ["fsCFAa", -19.28, 147.06, 5.00],
    ["frCGOco+1992.5+frCGOa", -40.68, 144.68, 130.50],
]

CARBOSCOPE_79_LONLAT = [[loc[2], loc[1]] for loc in CARBOSCOPE_79_LOCATIONS]

# cells = []
# for i in tqdm(range(len(ds.cell))):
#     a = obspack.isel(cell = i)[["lat", "lon"]].to_array("pos").dropna(dim = "time").values
#     cells.append(np.unique(a.T.round(1), axis = 0))

OBSPACK_287_IDXS = [
    0, 4, 5, 6, 9, 14, 19, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 41, 42, 43, 45, 46, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 120, 121, 129, 130, 131, 132, 133, 134, 135, 136, 137, 139, 140, 141, 142, 143, 144, 145, 146, 149, 150, 151, 157, 159, 160, 162, 163, 165, 166, 167, 169, 170, 171, 173, 174, 175, 176, 178, 179, 180, 181, 182, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 204, 205, 207, 208, 213, 214, 215, 216, 217, 218, 221, 222, 223, 224, 225, 226, 228, 229, 230, 231, 232, 233, 234, 235, 239, 240, 241, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 308, 309, 310, 311, 312, 313, 315, 316, 318, 319, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 351, 352, 353, 355, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 373, 374, 375, 376, 377, 378, 379, 381, 383, 385, 386, 387, 388, 389, 390, 391, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 426, 427, 430, 431, 432, 433, 434, 435, 436, 437, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 455, 459, 460, 461, 462, 468, 469, 470, 471, 472, 473, 477, 478, 479, 483, 484, 485, 486, 487, 488, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 505, 506, 507, 508, 509, 510, 511, 512, 513, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 534, 535, 536, 537, 538, 546, 547, 548, 549, 550, 551, 552, 554, 557, 558, 559, 560, 561, 564, 565, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 595, 596, 597, 598, 599, 600, 601, 602, 603, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616,
]

OBSPACK_287_LONLAT = [
    [-24.799999237060547, -90.0], [-8.300000190734863, -70.69999694824219], [39.599998474121094, -69.0], [62.900001525878906, -67.5999984741211], [110.5, -66.30000305175781], [-64.0999984741211, -64.80000305175781], [159.0, -54.5], [-38.0, -54.0], [51.79999923706055, -46.400001525878906], [174.89999389648438, -41.400001525878906], [144.6999969482422, -40.70000076293945], [142.8000030517578, -38.5], [77.5, -38.0], [77.5, -37.79999923706055], [18.5, -34.400001525878906], [-177.89999389648438, -29.200000762939453], [148.5, -23.899999618530273], [15.0, -23.600000381469727], [55.400001525878906, -21.100000381469727], [147.10000610351562, -19.299999237060547], [-170.60000610351562, -14.199999809265137], [-38.20000076293945, -12.800000190734863], [130.60000610351562, -12.399999618530273], [131.0, -12.199999809265137], [-14.399999618530273, -8.0], [-35.20000076293945, -5.800000190734863], [55.5, -4.699999809265137], [-38.29999923706055, -4.199999809265137], [100.30000305175781, -0.20000000298023224], [37.29999923706055, -0.10000000149011612], [32.5, 0.0], [-157.1999969482422, 1.7000000476837158], [-159.39999389648438, 3.9000000953674316], [-59.400001525878906, 13.199999809265137], [144.6999969482422, 13.399999618530273], [73.80000305175781, 15.100000381469727], [-24.899999618530273, 16.899999618530273], [-64.80000305175781, 17.799999237060547], [-97.30000305175781, 19.0], [-155.60000610351562, 19.5], [-154.89999389648438, 19.600000381469727], [-155.5, 19.799999237060547], [116.69999694824219, 20.700000762939453], [114.30000305175781, 22.200000762939453], [-110.19999694824219, 23.299999237060547], [5.599999904632568, 23.299999237060547], [120.9000015258789, 23.5], [154.0, 24.299999237060547], [123.0, 24.5], [-80.19999694824219, 25.700000762939453], [99.4000015258789, 28.0], [-177.39999389648438, 28.200000762939453], [-16.5, 28.299999237060547], [114.19999694824219, 29.600000381469727], [-82.19999694824219, 29.700000762939453], [-85.80000305175781, 30.200000762939453], [119.69999694824219, 30.299999237060547], [-102.80000305175781, 30.899999618530273], [-97.30000305175781, 31.299999237060547], [-89.69999694824219, 31.899999618530273], [-102.80000305175781, 32.0], [-104.4000015258789, 32.20000076293945], [-64.9000015258789, 32.29999923706055], [-64.5999984741211, 32.400001525878906], [-92.30000305175781, 32.5], [-83.0, 32.70000076293945], [-117.30000305175781, 32.900001525878906], [-103.80000305175781, 32.900001525878906], [-85.9000015258789, 33.20000076293945], [126.19999694824219, 33.29999923706055], [-81.80000305175781, 33.400001525878906], [-118.30000305175781, 33.70000076293945], [-89.9000015258789, 33.79999923706055], [-80.5, 33.900001525878906], [-118.0999984741211, 34.099998474121094], [-118.0999984741211, 34.20000076293945], [-85.30000305175781, 35.20000076293945], [25.700000762939453, 35.29999923706055], [12.600000381469727, 35.5], [-78.0999984741211, 35.79999923706055], [-84.30000305175781, 35.900001525878906], [14.899999618530273, 36.0], [-5.699999809265137, 36.099998474121094], [100.9000015258789, 36.29999923706055], [-109.0999984741211, 36.5], [126.30000305175781, 36.5], [-97.5, 36.599998474121094], [-79.4000015258789, 36.70000076293945], [-5.400000095367432, 36.70000076293945], [126.0999984741211, 36.70000076293945], [-77.5999984741211, 37.5], [130.89999389648438, 37.5], [-122.5, 37.79999923706055], [-121.5, 38.29999923706055], [-2.5999999046325684, 38.29999923706055], [-76.0, 38.5], [-78.4000015258789, 38.599998474121094], [-92.19999694824219, 38.70000076293945], [-123.69999694824219, 39.0], [141.8000030517578, 39.0], [-79.5, 39.099998474121094], [-28.0, 39.099998474121094], [-86.5, 39.599998474121094], [-86.4000015258789, 39.599998474121094], [-86.0999984741211, 39.599998474121094], [-86.0999984741211, 39.70000076293945], [-85.9000015258789, 39.70000076293945], [-86.30000305175781, 39.79999923706055], [-86.19999694824219, 39.79999923706055], [-86.0, 39.79999923706055], [-113.69999694824219, 39.900001525878906], [-86.19999694824219, 39.900001525878906], [-86.0, 39.900001525878906], [-85.69999694824219, 39.900001525878906], [-105.0, 40.0], [-86.69999694824219, 40.0], [-86.0, 40.0], [-105.5999984741211, 40.099998474121094], [-5.199999809265137, 40.29999923706055], [-106.69999694824219, 40.400001525878906], [-112.0999984741211, 40.5], [-111.80000305175781, 40.5], [-111.9000015258789, 40.599998474121094], [-111.5999984741211, 40.599998474121094], [117.0999984741211, 40.599998474121094], [-111.9000015258789, 40.70000076293945], [0.800000011920929, 40.70000076293945], [-111.9000015258789, 40.79999923706055], [-111.80000305175781, 40.79999923706055], [-92.9000015258789, 40.79999923706055], [-76.9000015258789, 40.900001525878906], [-124.19999694824219, 41.099998474121094], [-96.5, 41.099998474121094], [-74.5, 41.099998474121094], [-96.5, 41.20000076293945], [-90.0, 41.29999923706055], [-88.9000015258789, 41.29999923706055], [-70.5999984741211, 41.29999923706055], [-72.9000015258789, 41.400001525878906], [-76.4000015258789, 41.5], [-1.100000023841858, 41.599998474121094], [-91.4000015258789, 41.70000076293945], [-70.5, 41.70000076293945], [-75.69999694824219, 41.79999923706055], [-4.900000095367432, 41.79999923706055], [-8.0, 42.0], [3.200000047683716, 42.0], [-71.0999984741211, 42.29999923706055], [-71.0999984741211, 42.400001525878906], [-72.19999694824219, 42.5], [-80.5999984741211, 42.599998474121094], [1.0, 42.599998474121094], [-94.4000015258789, 42.79999923706055], [-74.80000305175781, 42.900001525878906], [-3.200000047683716, 42.900001525878906], [0.10000000149011612, 42.900001525878906], [9.399999618530273, 43.0], [0.4000000059604645, 43.099998474121094], [77.9000015258789, 43.20000076293945], [-119.69999694824219, 43.5], [-95.4000015258789, 43.5], [-79.4000015258789, 43.599998474121094], [-72.19999694824219, 43.70000076293945], [-60.0, 43.900001525878906], [5.699999809265137, 43.900001525878906], [-121.69999694824219, 44.0], [-123.5999984741211, 44.099998474121094], [-98.5999984741211, 44.099998474121094], [-91.30000305175781, 44.099998474121094], [-79.80000305175781, 44.20000076293945], [10.699999809265137, 44.20000076293945], [28.700000762939453, 44.20000076293945], [-1.2000000476837158, 44.400001525878906], [-123.5999984741211, 44.5], [-121.5999984741211, 44.5], [111.0999984741211, 44.5], [-123.5999984741211, 44.599998474121094], [-124.0999984741211, 44.70000076293945], [-93.0999984741211, 44.70000076293945], [127.5999984741211, 44.70000076293945], [-122.69999694824219, 45.0], [-68.69999694824219, 45.0], [-124.0, 45.5], [3.0, 45.79999923706055], [8.600000381469727, 45.79999923706055], [-90.30000305175781, 45.900001525878906], [7.699999809265137, 45.900001525878906], [8.0, 46.5], [8.0, 46.599998474121094], [16.700000762939453, 47.0], [87.9000015258789, 47.099998474121094], [8.199999809265137, 47.20000076293945], [11.0, 47.400001525878906], [-95.4000015258789, 47.5], [8.399999618530273, 47.5], [11.0, 47.79999923706055], [7.900000095367432, 47.900001525878906], [2.0999999046325684, 48.0], [-124.5999984741211, 48.29999923706055], [-105.0999984741211, 48.29999923706055], [-3.9000000953674316, 48.400001525878906], [5.5, 48.599998474121094], [-98.80000305175781, 48.70000076293945], [2.0999999046325684, 48.70000076293945], [-3.5999999046325684, 48.79999923706055], [-122.30000305175781, 49.0], [8.399999618530273, 49.099998474121094], [20.0, 49.20000076293945], [-126.5, 49.400001525878906], [8.699999809265137, 49.400001525878906], [15.100000381469727, 49.599998474121094], [-74.30000305175781, 49.70000076293945], [-75.0, 49.79999923706055], [-81.5999984741211, 49.900001525878906], [-145.0, 50.0], [11.800000190734863, 50.0], [-104.69999694824219, 50.20000076293945], [6.400000095367432, 50.900001525878906], [82.0999984741211, 51.29999923706055], [-110.19999694824219, 51.70000076293945], [10.5, 51.79999923706055], [-2.5, 52.0], [4.900000095367432, 52.0], [-6.400000095367432, 52.20000076293945], [14.100000381469727, 52.20000076293945], [1.100000023841858, 52.5], [174.10000610351562, 52.70000076293945], [1.100000023841858, 53.0], [8.5, 53.0], [11.399999618530273, 53.099998474121094], [22.799999237060547, 53.20000076293945], [23.0, 53.20000076293945], [-9.899999618530273, 53.29999923706055], [6.400000095367432, 53.400001525878906], [-105.0999984741211, 54.0], [-35.0, 54.0], [7.900000095367432, 54.20000076293945], [-105.0, 54.400001525878906], [-1.2000000476837158, 54.400001525878906], [62.29999923706055, 54.5], [73.0, 54.70000076293945], [8.300000190734863, 54.900001525878906], [-112.5, 55.0], [-112.4000015258789, 55.0], [36.599998474121094, 55.099998474121094], [-162.6999969482422, 55.20000076293945], [-7.300000190734863, 55.400001525878906], [13.399999618530273, 56.099998474121094], [84.30000305175781, 56.099998474121094], [-3.0, 56.599998474121094], [82.4000015258789, 58.20000076293945], [27.299999237060547, 58.29999923706055], [8.300000190734863, 58.400001525878906], [-93.80000305175781, 58.70000076293945], [-122.5999984741211, 58.79999923706055], [21.399999618530273, 59.79999923706055], [70.9000015258789, 59.79999923706055], [-1.2999999523162842, 60.099998474121094], [17.5, 60.099998474121094], [89.4000015258789, 60.79999923706055], [-48.20000076293945, 61.20000076293945], [24.299999237060547, 61.79999923706055], [129.39999389648438, 62.099998474121094], [-115.9000015258789, 62.79999923706055], [27.700000762939453, 62.900001525878906], [64.4000015258789, 63.20000076293945], [-20.299999237060547, 63.400001525878906], [75.80000305175781, 63.400001525878906], [-96.0, 64.30000305175781], [19.799999237060547, 64.30000305175781], [-147.60000610351562, 65.0], [2.0, 66.0], [24.100000381469727, 68.0], [-133.5, 68.30000305175781], [-105.0999984741211, 69.0999984741211], [-149.89999389648438, 70.5], [29.200000762939453, 70.80000305175781], [-156.60000610351562, 71.30000305175781], [128.89999389648438, 71.5999984741211], [129.0, 71.80000305175781], [-38.400001525878906, 72.5999984741211], [-119.4000015258789, 76.19999694824219], [149.5, 76.19999694824219], [11.899999618530273, 78.9000015258789], [-16.399999618530273, 81.4000015258789], [-16.600000381469727, 81.5999984741211], [-62.5, 82.5],
]

# fmt: on
